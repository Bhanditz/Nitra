namespace CSharp
{
  declarations Member : TypeMember
  {
    | Constructor
      {
        Parameters : FormalParameter*;
        Attributes : AttributeSection*;
      }
    | Destructor
      {
        Parameters : FormalParameter*;
        Attributes : AttributeSection*;
      }
    | Method
      {
        InterfaceType            : QualifiedReference?;
        TypeParameters           : TypeParameter*;
        TypeParameterConstraints : TypeParameterConstraintsClause*;
        IsPartial                : bool;
        Parameters               : FormalParameter*;
        ReturnType               : QualifiedReference;
        Attributes               : AttributeSection*;
      }
    | Property
      {
        InterfaceType : QualifiedReference?;
        Type          : QualifiedReference;
        Accessors     : PropertyAccessor*;
        Attributes    : AttributeSection*;
      }
    | Event
      {
        InterfaceType : QualifiedReference?;
        Header        : EventHeader;
        Accessors     : EventAccessor*;
      }
    | Indexer
      {
        Parameters    : FormalParameter*;
        Type          : QualifiedReference;
        InterfaceType : QualifiedReference?;
        Accessors     : PropertyAccessor*;
        Attributes    : AttributeSection*;
      }
    | Constant
    | Field           { Header : FieldHeader; }
    | FixedSizeBuffer { Header : FixedSizeBufferHeader; }
    | OperatorUnary
      {
        ReturnType : QualifiedReference;
        Parameter  : FormalParameter;
        Attributes : AttributeSection*;
      }
    | OperatorBinary
      {
        ReturnType : QualifiedReference;
        Parameter1 : FormalParameter;
        Parameter2 : FormalParameter;
        Attributes : AttributeSection*;
      }
    | OperatorCnv
      {
        ReturnType : QualifiedReference;
        Parameter  : FormalParameter;
        Attributes : AttributeSection*;
      }
    | EnumMember
      {
        Attributes : AttributeSection*;
      }
  }

  ast FieldHeader
  {
    Type       : QualifiedReference;
    Attributes : AttributeSection*;
  }

  ast EventHeader
  {
    Type       : QualifiedReference;
    Attributes : AttributeSection*;
  }

  ast FixedSizeBufferHeader
  {
    Type       : QualifiedReference;
    Attributes : AttributeSection*;
  }

  declaration FormalParameter
  {
    Type       : QualifiedReference;
    Attributes : AttributeSection*;
  }

  asts PropertyAccessor
  {
    Attributes : AttributeSection*;

    | Get
    | Set
  }

  asts EventAccessor
  {
    Attributes : AttributeSection*;

    | Add
    | Remove
  }

  map syntax TopDeclarations.FormalParameter -> FormalParameter
  {
    Name       -> Name;
    AnyType    -> Type;
    Attributes -> Attributes;
  }

  map syntax TopDeclarations.FormalParameters -> FormalParameter*
  {
    FormalParameters.Item1
  }

  map syntax Statements.ConstantDeclarator -> Member.Constant
  {
    Name -> Name;
  }

  map syntax TopDeclarations.FixedSizeBufferDeclarator(header : FixedSizeBufferHeader) -> Member.FixedSizeBuffer
  {
    Name   -> Name;
    header -> Header;
  }

  map syntax TopDeclarations.GetAccessorDeclaration -> PropertyAccessor.Get { Attributes -> Attributes; }

  map syntax TopDeclarations.SetAccessorDeclaration -> PropertyAccessor.Set { Attributes -> Attributes; }

  map syntax TopDeclarations.AccessorDeclarations -> PropertyAccessor*
  {
    | GetSet(g, Some(s)) -> [g, s]
    | GetSet(g, None)    -> [g]
    | SetGet(s, Some(g)) -> [s, g]
    | SetGet(s, None)    -> [s]
    | None               -> []
  }

  map syntax TopDeclarations.AddAccessorDeclaration -> EventAccessor.Add { Attributes -> Attributes; }

  map syntax TopDeclarations.RemoveAccessorDeclaration -> EventAccessor.Remove { Attributes -> Attributes; }

  map syntax TopDeclarations.EventAccessorDeclarations -> EventAccessor*
  {
    | AddRemove(a, r) -> [a, r]
    | RemoveAdd(r, a) -> [r, a]
  }
}
