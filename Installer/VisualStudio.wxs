<?xml version="1.0" encoding="UTF-8"?>

<?include Variables.wxi ?>

<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:VSExtension="http://schemas.microsoft.com/wix/VSExtension" xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">
  <Fragment>
    <ComponentGroup Id="VisualStudioComponents" Directory="INSTALLFOLDER">
      <ComponentRef Id="Comp_VisualStudio" />
    </ComponentGroup>

    <DirectoryRef Id="INSTALLFOLDER">
      <Component Id="Comp_VisualStudio" DiskId="1" Guid="$(var.Comp_VisualStudio_Guid)">
        <File Id="File_N2.VisualStudio.vsix" Name="N2.VisualStudio.vsix" Source="$(var.VisualStudioPackageSourcePath)">
          <VSExtension:VsixPackage PackageId="N2..3BFC7A3D-B2D0-433C-A271-6A325287410F" Permanent="no" Vital="no" />
        </File>
        <File Id="File_N2GlobalConfig.xml" Name="N2GlobalConfig.xml" Source="N2GlobalConfig.xml" />
        <Environment Id="Env_N2PATH" Name="N2PATH" System="yes" Permanent="no" Part="all" Action="set" Value="[INSTALLFOLDER]" />
        <File Id="File_CSharp.Grammar.dll" Name="CSharp.Grammar.dll" Source="$(var.GrammarBinariesSourcePath)">
          <netfx:NativeImage Priority="1" Platform="all" Id="Image_CSharp.Grammar.dll" Dependencies="no" AppBaseDirectory="INSTALLFOLDER" />
        </File>
        <File Id="File_Json.Grammar.dll" Name="Json.Grammar.dll" Source="$(var.GrammarBinariesSourcePath)">
          <netfx:NativeImage Priority="1" Platform="all" Id="Image_Json.Grammar.dll" Dependencies="no" AppBaseDirectory="INSTALLFOLDER" />
        </File>
      </Component>
    </DirectoryRef>
  </Fragment>
</Wix>